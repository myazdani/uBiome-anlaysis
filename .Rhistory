strsplit(as.character(pairwise.res$pairs[1]), split = "\.")
strsplit(as.character(pairwise.res$pairs[1]), split = "/.")
strsplit(as.character(pairwise.res$pairs[1]), split = "//.")
strsplit(as.character(pairwise.res$pairs[1]), split = "X.")
strsplit(as.character(pairwise.res$pairs[1]), split = "X....")
strsplit(as.character(pairwise.res$pairs[1]), split = "X.....")
strsplit(as.character(pairwise.res$pairs[1]), split = "X.....")[[1]][2]
substr(strsplit(as.character(pairwise.res$pairs[1]), split = "X.....")[[1]][2], 1, 4)
min(2014,2015)
get.base.year = function(x){
year.1 = as.numeric(substr(strsplit(as.character(x), split = "X.....")[[1]][1], 1, 4))
year.2 = as.numeric(substr(strsplit(as.character(x), split = "X.....")[[1]][2], 1, 4))
return(min(year.1, year.2))
}
get.base.year(pairwise.res$pairs[1])
x = pairwise.res$pairs[1]
x
year.1 = as.numeric(substr(strsplit(as.character(x), split = "X.....")[[1]][1], 1, 4))
as.character(x)
substr(strsplit(as.character(x), split = "X.....")
)
strsplit(as.character(x), split = "X.....")
strsplit(as.character(x), split = "X.....")[[1]][1]
get.base.year = function(x){
year.1 = as.numeric(substr(strsplit(as.character(x), split = "X.....")[[1]][2], 1, 4))
year.2 = as.numeric(substr(strsplit(as.character(x), split = "X.....")[[1]][3], 1, 4))
return(min(year.1, year.2))
}
get.base.year(pairwise.res$pairs[1])
get.base.year(pairwise.res$pairs[2])
get.base.year(pairwise.res$pairs[3])
get.base.year(pairwise.res$pairs[4])
pairwise.res$pairs[4]
pairwise.res$pairs[4] -> x
x
year.1 = as.numeric(substr(strsplit(as.character(x), split = "X.....")[[1]][2], 1, 4))
year.1
year.2 = as.numeric(substr(strsplit(as.character(x), split = "X.....")[[1]][3], 1, 4))
strsplit(as.character(x), split = "X.....")[[1]][3]
strsplit(as.character(x), split = "X.....")
strsplit(as.character(x), split = "-")
length(strsplit(as.character(x), split = "-")[[1]][1])
nchar(strsplit(as.character(x), split = "-")[[1]][1])
nchar(strsplit(as.character(x), split = "-")[[1]][2])
x
year.1.chars = strsplit(as.character(x), split = "-")[[1]][1]
year.1.chars
year.2.chars = strsplit(as.character(x), split = "-")[[1]][2]
year.2.chars
year.1 = substr(year.1.chars, nchar(year.1.chars)-4, nchar(year.1.chars))
year.1
year.1 = as.numeric(substr(year.1.chars, nchar(year.1.chars)-4, nchar(year.1.chars)))
year.1
get.base.year = function(x){
year.1.chars = strsplit(as.character(x), split = "-")[[1]][1]
year.2.chars = strsplit(as.character(x), split = "-")[[1]][2]
year.1 = as.numeric(substr(year.1.chars, nchar(year.1.chars)-4, nchar(year.1.chars)))
year.2 = as.numeric(substr(year.2.chars, nchar(year.2.chars)-4, nchar(year.2.chars)))
return(min(year.1, year.2))
}
get.base.year(x)
x
year.1.chars = strsplit(as.character(x), split = "-")[[1]][1]
year.2.chars = strsplit(as.character(x), split = "-")[[1]][2]
year.1 = as.numeric(substr(year.1.chars, nchar(year.1.chars)-4, nchar(year.1.chars)))
year.2 = as.numeric(substr(year.2.chars, nchar(year.2.chars)-4, nchar(year.2.chars)))
year.2.chars
year.2 = as.numeric(substr(year.2.chars, nchar(year.2.chars)-4, nchar(year.2.chars)-1))
year.2
get.base.year = function(x){
year.1.chars = strsplit(as.character(x), split = "-")[[1]][1]
year.2.chars = strsplit(as.character(x), split = "-")[[1]][2]
year.1 = as.numeric(substr(year.1.chars, nchar(year.1.chars)-4, nchar(year.1.chars)))
year.2 = as.numeric(substr(year.2.chars, nchar(year.2.chars)-4, nchar(year.2.chars)-1))
return(min(year.1, year.2))
}
get.base.year(x)
pairwise.res$base.year = sapply(pairwise.res$pairs, get.base.year)
table(pairwise.res$base.year)
ggplot(pairwise.res, aes(x = time.difference, y = source.matrix.distances, label = pairs, colours = base.year)) + geom_text() -> p
library(plotly)
py$ggplotly(p, kwargs=list(filename="LS-ubiome", fileopt="overwrite"))
print(p)
head(pairwise.res)
pairwise.res$base.year = as.factor(pairwise.res$base.year)
ggplot(pairwise.res, aes(x = time.difference, y = source.matrix.distances, label = pairs, colours = base.year)) + geom_point() -> p
print(p)
ggplot(pairwise.res, aes(x = time.difference, y = source.matrix.distances, label = pairs, colour = base.year)) + geom_point() -> p
print(p)
ggplot(pairwise.res, aes(x = time.difference, y = source.matrix.distances, label = pairs, colours = base.year)) + geom_text()) -> p
ggplot(pairwise.res, aes(x = time.difference, y = source.matrix.distances, label = pairs, colours = base.year)) + geom_text() -> p
py$ggplotly(p, kwargs=list(filename="LS-ubiome", fileopt="overwrite"))
ggplot(pairwise.res, aes(x = time.difference, y = source.matrix.distances, label = pairs, colour = base.year)) + geom_text() -> p
print(p)
py$ggplotly(p, kwargs=list(filename="LS-ubiome", fileopt="overwrite"))
ggplot(pairwise.res, aes(x = time.difference, y = source.matrix.distances, label = pairs)) + geom_text() -> p
py$ggplotly(p, kwargs=list(filename="LS-ubiome", fileopt="overwrite"))
library(devtools)
install_github("myazdani/pairwise-dist")
library(pairwiseDist)
library(pairwiseDist)
library(pairwiseDist)
library(pairwiseDist)
?pairwise.squared.diff
??pairwise.squared.diff
install_github("myazdani/pairwise-dist")
library(devtools)
install_github("myazdani/pairwise-dist")
library(pairwiseDist)
devtools::install_github("yazdani/pairwise-dist")
devtools::install_github("myazdani/pairwise-dist")
library(pairwiseDist)
library(pairwiseDist)
## prepare-pairwise-diff-data.R
##
setwd("~/Documents/uBiome-analysis/")
## prepare-pairwise-diff-data.R
##
setwd("~/Documents/uBiome-analysis/")
df = read.csv("./processedData/merged-excel-sheets/transposed/genus-data-TRANSPOSED.csv", header = TRUE, stringsAsFactors = FALSE)
head(df)
df[is.na(df)] = 0
head(df)
#change to a date data type
df$date = sapply(df$date, FUN = function(x) as.POSIXct(x, format = "%m.%d.%Y"))
head(df)
setwd("~/Documents/uBiome-analysis/")
df = read.csv("./processedData/merged-excel-sheets/transposed/genus-data-TRANSPOSED.csv", header = TRUE, stringsAsFactors = FALSE)
df[is.na(df)] = 0
df$date = as.Date(df$date, format='%m.%d.%Y')
head(df)
pairwise.squared.diff = function(df, desired.key = TRUE){
if(class(df) != "data.frame"){
df = as.data.frame(df)
}
indx = as.data.frame(combn(c(1:nrow(df)), 2))
take.diff = function(x){
row.diff = as.data.frame(df[x[1], ] - df[x[2],])
row.names(row.diff) = paste(x[1], "-", x[2])
return(row.diff)
}
res = lapply(indx, take.diff)
res = do.call(rbind,res)
row.names(res) = sapply(indx, FUN = function(x) paste(x[1], "-", x[2]))
return(res**2)
}
df.pairs = pairwise.squared.diff(df[,-which(names(df) %in% "date")])
df$date
names(df.pairs)
names(as.data.frame(df.pairs))
row.names(as.data.frame(df.pairs))
date.pairs = as.data.frame(pairwise.squared.diff(df[,which(names(df) %in% "date")]))
df[,which(names(df) %in% "date")]
sapply(df[,which(names(df) %in% "date")], FUN = function(x) as.POSIXct(x))
dates.in.unix = sapply(df[,which(names(df) %in% "date")], FUN = function(x) as.POSIXct(x))
date.pairs = as.data.frame(pairwise.squared.diff(dates.in.unix))
head(date.pairs)
dates.in.unix = sapply(df[,which(names(df) %in% "date")], FUN = function(x) as.POSIXct(x))/100
date.pairs = as.data.frame(pairwise.squared.diff(dates.in.unix))
head(date.pairs)
pairwise.abs.diff = function(df, desired.key = TRUE){
if(class(df) != "data.frame"){
df = as.data.frame(df)
}
indx = as.data.frame(combn(c(1:nrow(df)), 2))
take.diff = function(x){
row.diff = as.data.frame(df[x[1], ] - df[x[2],])
row.names(row.diff) = paste(x[1], "-", x[2])
return(row.diff)
}
res = lapply(indx, take.diff)
res = do.call(rbind,res)
row.names(res) = sapply(indx, FUN = function(x) paste(x[1], "-", x[2]))
return(abs(res))
}
date.pairs = as.data.frame(pairwise.abs.diff(dates.in.unix))
head(date.pairs)
?as.POSIXct.Date
dates.in.unix = sapply(df[,which(names(df) %in% "date")], FUN = function(x) as.POSIXct.date(x))
dates.in.unix = sapply(df[,which(names(df) %in% "date")], FUN = function(x) as.POSIXct.Date(x))
dates.in.unix
dates.in.unix = sapply(df[,which(names(df) %in% "date")], FUN = function(x) as.POSIXct(x))/100
date.pairs = as.data.frame(pairwise.abs.diff(dates.in.unix))
head(date.pairs)
head(df$date)
names(date.pairs) = "date.difference"
head(date.pairs)
source('~/Documents/uBiome-analysis/scripts/data-manip/prepare-pairwise-diff-data.R')
df.res = merge(date.pairs, df.pairs)
head(df.res)
write.csv(df.res, file = "./processedData/pairwise-differences/genus-pairwise-time-diff.csv", row.names = FALSE, quote = FALSE)
nrow(df.res)
dim(df.res)
head(df.res)
head(date.pairs)
rownames(df)
df$date
x  = date.pairs$row.key[1]
x
strsplit(x, split = "-")
strsplit(x, split = "-")[[1]][1]
strsplit(x, split = "-")[[1]][2]
as.numeric(strsplit(x, split = "-")[[1]][2])
date.pairs$date.diff = sapply(date.pairs$row.key, FUN = function(x) paste(df$date[as.numeric(strsplit(x, split = "-")[[1]][1])]), "-", df$date[as.numeric(strsplit(x, split = "-")[[1]][2])])
date.pairs$date.diff = sapply(date.pairs$row.key, FUN = function(x) paste(df$date[as.numeric(strsplit(x, split = "-")[[1]][1]), "-", df$date[as.numeric(strsplit(x, split = "-")[[1]][2])]))
df$date[as.numeric(strsplit(x, split = "-")[[1]][1])
df$date[as.numeric(strsplit(x, split = "-")[[1]][1])]
date.pairs$date.diff = sapply(date.pairs$row.key, FUN = function(x) paste(df$date[as.numeric(strsplit(x, split = "-")[[1]][1])], "-", df$date[as.numeric(strsplit(x, split = "-")[[1]][2])]))
head(date.pairs)
df.res = merge(date.pairs, df.pairs)
df.res$row.key = NULL
head(df.res)
write.csv(df.res, file = "./processedData/pairwise-differences/genus-pairwise-time-diff.csv", row.names = FALSE, quote = FALSE)
df = read.csv("./processedData/merged-excel-sheets/genus-data.csv", header = TRUE, stringsAsFactors = FALSE)
head(df)
df.T = read.csv("./processedData/merged-excel-sheets/transposed/genus-data-TRANSPOSED.csv", header = TRUE, stringsAsFactors = FALSE)
head(df.T)
sapply(df, max)
sapply(df.T, max)
sapply(df.T, FUN = function(x) max(x, na.rm = TRUE))
lapply(df.T, FUN = function(x) max(x, na.rm = TRUE)) -> max.bugs
names(max.bugs)
max.bugs$Citrobacter
max.bugs$Robinsoniella
max.bugs$Olsenella
max.bugs$Paenibacillus
max.bugs$Shuttleworthia
max.bugs$Peptostreptococcus
min(max.bugs)
sapply(df.T[,-1], FUN = function(x) max(x, na.rm = TRUE)) -> max.bugs
max.bugs
sapply(df.T[,-ncol(df.T)], FUN = function(x) max(x, na.rm = TRUE)) -> max.bugs
max.bugs[order(max.bugs)]
sapply(df.T[,-ncol(df.T)], FUN = function(x) min(x, na.rm = TRUE)) -> min.bugs
min.bugs
head(max.bugs)
head(min.bugs)
bug.r = max.bugs/min.bugs
bug.r[order(bug.r)]
head(max.bugs)
names(max.bugs)
bug.r[order(bug.r)]
head(df)
head(df.T)
num.NAS = sapply(df.T[,-ncol(df.T)], FUN = function(x) length(which(is.na(x))))
num.NAS
max(num.NAS)
min(num.NAS)
num.NAS[order(num.NAS)]
head(num.NAS[order(num.NAS)], 10)
head(num.NAS[order(num.NAS)], 20)
head(num.NAS[order(num.NAS)], 30)
head(num.NAS[order(num.NAS)], 25)
head(num.NAS[order(num.NAS)], 25)
min.bugs
head(min.bugs[order(min.bugs)])
head(min.bugs[order(min.bugs)], 20)
head(min.bugs[order(min.bugs)], 30)
head(min.bugs[order(min.bugs)], 50)
head(min.bugs[order(min.bugs)], 100)
head(max.bugs[order(min.bugs)], 100)
3e-4
source('~/Documents/uBiome-analysis/scripts/data-manip/filter-low-abundant-bugs.R')
head(df)
max.bugs = sapply(df[,-c(1,2)], max)
max.bugs
filter_thresh = 3e-4
which(max.bugs > filter_thresh)
source('~/Documents/uBiome-analysis/scripts/data-manip/filter-low-abundant-bugs.R')
which(max.bugs > filter_thresh)
df = read.csv("./processedData/merged-excel-sheets/transposed/genus-data-TRANSPOSED.csv", header = TRUE, stringsAsFactors = FALSE)
head(df)
df = read.csv("./processedData/merged-excel-sheets/genus-data.csv", header = TRUE, stringsAsFactors = FALSE)
head(df)
head(df)
?apply
names(df)
max.bugs = apply(df[,-1], 1, max)
max.bugs
max.bugs = apply(df[,-1], 1, FUN = function(x) max(x, na.rm = TRUE))
max.bugs
df.filtered = df[which(max.bugs > filter_thresh),]
head(df.filtered)
source('~/Documents/uBiome-analysis/scripts/data-manip/filter-low-abundant-bugs.R')
head(df.filtered)
dim(df.filtered)
dim(df)
head(df.filtered)
source('~/Documents/uBiome-analysis/scripts/data-manip/filter-low-abundant-bugs.R')
## prepare-pairwise-diff-data.R
##
setwd("~/Documents/uBiome-analysis/")
df = read.csv("./processedData/merged-excel-sheets/transposed/genus-data-TRANSPOSED.csv", header = TRUE, stringsAsFactors = FALSE)
##
##!!!!---data clean up
##
df[is.na(df)] = 0
head(df)
max.bugs = sapply(df[,-ncol(df)], max)
max.bugs
filter_thresh = 1e-4
df.temp = df[,-which(max.bugs < filter_thresh)]
head(df.temp)
dim(df.temp)
dim(df)
source('~/Documents/uBiome-analysis/scripts/data-manip/prepare-pairwise-diff-data.R')
head(df.res)
dim(df.res)
head(df.res)
dim(df.res)
head(df.res)
df.temp = df.res
df.temp[,-c(1,2)]
head(df.temp[,-c(1,2)])
head(df.temp[,-c(1,2)]/df.temp[,1])
head(df.temp$date.difference)
0.000269/371520
0.000269/50976
0.000152/371520
0.000152/50976
df.res[,-c(1,2)] = df.res[,-c(1,2)]/df[,1]
head(df.res)
source('~/Documents/uBiome-analysis/scripts/data-manip/prepare-pairwise-diff-data.R')
write.csv(df.res, file = "./processedData/pairwise-differences/genus-pairwise-DERIVATIVE-high-abundant.csv", row.names = FALSE, quote = FALSE)
names(df.res)
df.res$mag.dist = apply(df.res[,-c(1,2)], 1, sum)
names(df.res)
head(df.res[,c("date.difference", "date.diff", "mag.dist")])
head(df.res[,c("date.difference", "date.diff", "mag.dist", names(df.res[,-c(1,2,ncol(df.res))]))])
head(df.res[,c("date.difference", "date.diff", "mag.dist", names(df.res[,-c(1,2,ncol(df.res))]))])
source('~/Documents/uBiome-analysis/scripts/data-manip/prepare-pairwise-diff-data.R')
head(df.res)
head(df.res[,c(1,2)])
library(ggplot2)
head(df.res[,c(1,2,3)])
ggplot(df.res, aes(x = date.difference, y = mag.dist, label = date.diff)) + geom_text() -> p
print(p)
library(plotly)
py = plotly()
py$ggplotly(p, kwargs=list(filename="LS-ubiome-pairwise-high-abundant-genus", fileopt="overwrite"))
ggplot(df.res, aes(x = date.difference, y = mag.dist, label = date.diff)) + geom_point() + geom_text()-> p
py$ggplotly(p, kwargs=list(filename="LS-ubiome-pairwise-high-abundant-genus", fileopt="overwrite"))
ggplot(df.res, aes(x = date.difference, y = mag.dist, label = date.diff)) + geom_text() + geom_point() -> p
py$ggplotly(p, kwargs=list(filename="LS-ubiome-pairwise-high-abundant-genus", fileopt="overwrite"))
bleh = data.frame(date.differences = df.res$date.difference, mag,dist = ruind(nrow(df.res), min = .2, max = . 95))
bleh = data.frame(date.differences = df.res$date.difference, mag.dist = ruind(nrow(df.res), min = .2, max = . 95))
bleh = data.frame(date.differences = df.res$date.difference, mag.dist = ruind(nrow(df.res), min = .2, max = . 95)))
bleh = data.frame(date.differences = df.res$date.difference, mag.dist = ruinf(nrow(df.res), min = .2, max = . 95)))
bleh = data.frame(date.differences = df.res$date.difference, mag.dist = ruinf(nrow(df.res), min = .2, max = . 95))
mag.dist = ruinf(nrow(df.res), min = .2, max = . 95)
bleh = data.frame(date.differences = df.res$date.difference, mag.dist = runif(nrow(df.res), min = .2, max = . 95))
head(runif(nrow(df.res), min = .2, max = . 95))
?runit
?runif
runif(nrow(df.res))
runif(nrow(df.res), min = .1, max = .9)
bleh = data.frame(date.differences = df.res$date.difference, mag.dist = runif(nrow(df.res), min = .2, max = .9))
ggplot(bleh, aes(x = date.difference, y = mag.dist, label = date.diff)) + geom_text() + geom_point() -> p.noise
py$ggplotly(p.noise, kwargs=list(filename="NOISE-pairwise-high-abundant-genus", fileopt="overwrite"))
ggplot(bleh, aes(x = date.differenceS, y = mag.dist, label = date.diff)) + geom_text() + geom_point() -> p.noise
ggplot(bleh, aes(x = date.differenced, y = mag.dist, label = date.diff)) + geom_text() + geom_point() -> p.noise
ggplot(bleh, aes(x = date.differences, y = mag.dist, label = date.diff)) + geom_text() + geom_point() -> p.noise
py$ggplotly(p.noise, kwargs=list(filename="NOISE-pairwise-high-abundant-genus", fileopt="overwrite"))
bleh = data.frame(date.difference = df.res$date.difference, mag.dist = runif(nrow(df.res), min = .2, max = .9), date.diff = df.res$date.diff)
ggplot(bleh, aes(x = date.differences, y = mag.dist, label = date.diff)) + geom_text() + geom_point() -> p.noise
py$ggplotly(p.noise, kwargs=list(filename="NOISE-pairwise-high-abundant-genus", fileopt="overwrite"))
ggplot(bleh, aes(x = date.difference, y = mag.dist, label = date.diff)) + geom_text() + geom_point() -> p.noise
py$ggplotly(p.noise, kwargs=list(filename="NOISE-pairwise-high-abundant-genus", fileopt="overwrite"))
res = read.delim("~/Desktop/result.txt", header = TRUE, stringsAsFactors = FALSE)
head(res)
summary(res)
head(res, 20)
head(res[order(res$T.test.p.value),], 30)
head(res)
head(res[order(res$T.test.p.value), ])
res = read.delim("~/Documents/uBiome-analysis/figures/Ayasdi/pairwise-analysis/stat-results/results-angle-PCA.txt", header = TRUE, stringsAsFactors = FALSE)
head(res)
head(res[order(res$T.test.p.value),], 30)
head(res)
head(res[order(res$T.test.p.value), ])
family.df = read.csv("./processedData/merged-excel-sheets/family-data.csv", header = TRUE, stringsAsFactors = FALSE)
head(family.df)
lapply(family.df[,-1], sum)
sapply(family.df[,-1], FUN = function(x) sum(x, na.rm = TRUE))
range(sapply(family.df[,-1], FUN = function(x) sum(x, na.rm = TRUE)))
library(readxl)
library(plyr)
data.path = "./data/Excel/"
excel.files = list.files(data.path, full.names = FALSE)
excel.files
i = 1
temp.df = as.data.frame(read_excel(paste0(data.path, excel.files[i]), sheet = sheets[sheet]))
sheet = "genus"
temp.df = as.data.frame(read_excel(paste0(data.path, excel.files[i]), sheet = sheets[sheet]))
sheets = c("family", "genus", "species")
sheet = 2
temp.df = as.data.frame(read_excel(paste0(data.path, excel.files[i]), sheet = sheets[sheet]))
head(temp.df)
sum(temp.df$abundance)
for (i in c(1:length(excel.files))){}
for (i in c(1:length(excel.files))){
temp.df = as.data.frame(read_excel(paste0(data.path, excel.files[i]), sheet = sheets[sheet]))
print(sum(temp.df$abundance))
}
sheet = 1
for (i in c(1:length(excel.files))){
temp.df = as.data.frame(read_excel(paste0(data.path, excel.files[i]), sheet = sheets[sheet]))
print(sum(temp.df$abundance))
}
sheet = 3
for (i in c(1:length(excel.files))){
temp.df = as.data.frame(read_excel(paste0(data.path, excel.files[i]), sheet = sheets[sheet]))
print(sum(temp.df$abundance))
}
for (i in c(1:length(excel.files))){
temp.df = as.data.frame(read_excel(paste0(data.path, excel.files[i]), sheet = "phylum"))
print(sum(temp.df$abundance))
}
excel.files
excel.files[order(excel.files)]
files.to.skip = c("9.25.2013 Ubiome kit 900-009-361.xls", "10.2.2013 Ubiome kit 380-002-047.xls",
"10.10.2013 Ubiome kit 900-003-627.xls", "10.23.2013 Ubiome kit 900-003-628.xls",
"2.17.2014 Ubiome kit 106-003-133.xls", "5.4.2014 Ubiome kit 151-003-131.xls")
length(files.to.skip)
length(excel.files)
length(setdiff(excel.files, files.to.skip))
34*33*.5
bleh = read.csv("./processedData/merged-excel-sheets/genus-data.csv", header = TRUE, stringsAsFactors = FALSE)
head(bleh)
head(temp.df)
## merge-sheets-excel.R
##
setwd("~/Documents/uBiome-analysis/")
#library(devtools)
#install_github("hadley/readxl")
#sheets = c("superkingdom", "phylum", "class", "order", "family", "genus", "species")
sheets = c("family", "genus", "species")
library(readxl)
library(plyr)
data.path = "./data/Excel/"
excel.files = list.files(data.path, full.names = FALSE)
files.to.skip = c("9.25.2013 Ubiome kit 900-009-361.xls", "10.2.2013 Ubiome kit 380-002-047.xls",
"10.10.2013 Ubiome kit 900-003-627.xls", "10.23.2013 Ubiome kit 900-003-628.xls",
"2.17.2014 Ubiome kit 106-003-133.xls", "5.4.2014 Ubiome kit 151-003-131.xls")
excel.files = setdiff(excel.files, files.to.skip)
sheet = 1
i = 1
temp.df = as.data.frame(read_excel(paste0(data.path, excel.files[i]), sheet = sheets[sheet]))
temp.df = temp.df[,c(sheets[sheet], "abundance")]
date.id = strsplit(excel.files[i], split = " Ubiome")[[1]][1]
if (date.id %in% date.ids) {
date.id = paste0(date.id, "-1")
}
data.files = list()
date.ids = c()
temp.df = as.data.frame(read_excel(paste0(data.path, excel.files[i]), sheet = sheets[sheet]))
temp.df = temp.df[,c(sheets[sheet], "abundance")]
date.id = strsplit(excel.files[i], split = " Ubiome")[[1]][1]
if (date.id %in% date.ids) {
date.id = paste0(date.id, "-1")
}
date.ids[i] = date.id
names(temp.df)[2] = paste(date.id, "abundance")
head(temp.df)
names(temp.df)
data.files = list()
date.ids = c()
for (i in c(1:length(excel.files))){
temp.df = as.data.frame(read_excel(paste0(data.path, excel.files[i]), sheet = sheets[sheet]))
temp.df = temp.df[,c(sheets[sheet], "abundance")]
date.id = strsplit(excel.files[i], split = " Ubiome")[[1]][1]
if (date.id %in% date.ids) {
date.id = paste0(date.id, "-1")
}
date.ids[i] = date.id
names(temp.df)[2] = paste(date.id, "abundance")
data.files[[i]] = temp.df
}
res = join_all(data.files, type = "full", match = "all")
head(res)
names(res)
names(res[,-1])
bleh = name(res[,-1])
bleh = names(res[,-1])
bleh
head(bleh)
bleh[order(bleh)]
date.cols = names(res[,-1])
date.cols = sapply(names(res[,-1]), FUN = function(x) strsplit(x, split = "abundance")[[1]][1])
date.cols
date.cols = unname(sapply(names(res[,-1]), FUN = function(x) strsplit(x, split = "abundance")[[1]][1]))
date.cols
date.cols = unname(sapply(names(res[,-1]), FUN = function(x) strsplit(x, split = " abundance")[[1]][1]))
date.cols
date.cols = as.Date(date.cols, format='%m.%d.%Y')
head(date.cols)
class(date.cols)
date.cols[order(date.cols)]
order(date.cols)
order(date.cols)+1
res.temp = res[,c(1,1+order(date.cols))]
head(res.temp)
source('~/Documents/uBiome-analysis/scripts/data-manip/merge-sheets-excel.R')
source('~/Documents/uBiome-analysis/scripts/data-manip/CSV-transposer.R')
source('~/Documents/uBiome-analysis/scripts/data-manip/CSV-transposer.R')
source('~/Documents/uBiome-analysis/scripts/data-manip/CSV-transposer.R')
source('~/Documents/uBiome-analysis/scripts/data-manip/CSV-transposer.R')
dim(df)
dim(df.T)
head(df)
source('~/Documents/uBiome-analysis/scripts/data-manip/filter-low-abundant-bugs.R')
source('~/Documents/uBiome-analysis/scripts/data-manip/prepare-pairwise-diff-data.R')
